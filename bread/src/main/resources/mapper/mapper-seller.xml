<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bitc.team5.mapper.SellerMapper">


<!--	<select id="getUsers" resultType="com.bitc.team2.dto.UserDtoo">
		<![CDATA[
			SELECT
				idx, title, creator_id, hit_cnt,
				DATE_FORMAT(created_date, '%Y.%m.%d %H:%i:%s') AS created_date
			FROM
				t_board
			WHERE
				deleted_yn = 'N'
			ORDER BY
				idx DESC
		]]>
	</select>-->
	
<!-- 사용자 렁오기-->
	<select id="getUsers" resultType="com.bitc.team5.dto.UsersDto">
		<![CDATA[
			SELECT
				*
			FROM
				user
			
			ORDER BY
				seq DESC
		]]>
	</select>

<!-- 상품 들고오기 -->
	<select id="selectProductList" resultType="com.bitc.team5.dto.ShopDto">
		<![CDATA[
		
			SELECT
				*
			FROM
				admin_product
			
			
		]]>
	</select>
	
	<!-- 상품 등록-->
	<insert id="insertBoard" parameterType="com.bitc.team5.dto.ShopDto" useGeneratedKeys="true" keyProperty="idx">
		<![CDATA[
			INSERT INTO admin_product
				(product_id , product_cate_id, product_name, product_price, product_description, product_stock_cnt, store_id)
			VALUES
				(#{productId}, #{productCateId}, #{productName}, #{productPrice}, #{productDescription}, #{productStockCnt}, #{storeId})
		]]>
	</insert>
	
	<!-- 상품 썽네일 등록 -->

	<insert id="insertBoardFileList" parameterType="com.bitc.team5.dto.AdminProductFileDto">
		<![CDATA[
			INSERT INTO product_file
				( board_idx, original_file_name, stored_file_path, file_size, creator_id, file_type, product_id)
			VALUES
		]]>
		<foreach collection="list" item="item" separator=",">
		(	#{item.boardIdx}, 
			#{item.originalFileName},
			#{item.storedFilePath},
			#{item.fileSize},
			'nickname5',
			#{item.fileType},
			#{item.productId} )
			
		</foreach>
	</insert>
	
      
<!-- 상세화면 -->
      <select id="selectBoardDetail" parameterType="int" resultType="com.bitc.team5.dto.ShopDto">
      <![CDATA[
         SELECT
            *
         FROM
             admin_product
        WHERE
             idx = #{idx}
         
      ]]>
      
   </select>
   
   <!-- 지정한 글번호에 첨부된 파일 목록 불러오기 -->
	<!-- (file_size / 1024) -> kb로 표현할라고  -->
	<select id="selectBoardFileList" parameterType="int" resultType="com.bitc.team5.dto.AdminProductFileDto">
		<![CDATA[
			SELECT
				file_idx, board_idx, original_file_name, stored_file_path,
				FORMAT(ROUND(file_size / 1024), 0) AS file_size
			FROM
				product_file
			WHERE
				board_idx = #{idx}
			
		]]>
	</select>

   
   <select id="selectBoardFileInfo" parameterType="map" resultType="com.bitc.team5.dto.AdminProductFileDto">
		<![CDATA[
			SELECT
				original_file_name, stored_file_path, file_size
			FROM
				product_file
			WHERE
				file_idx = #{fileIdx}
			AND
				board_idx = #{boardIdx}
			
		]]>
	</select>
	
	<!--<select id="selectBoardDetail" parameterType="int" resultType="com.bitc.dto.RestBoardDto">
		<![CDATA[
			SELECT
				idx, title, contents, creator_id, update_id, hit_cnt,
				DATE_FORMAT(created_date, '%Y.%m.%d %H:%i:%s') AS created_date,
				DATE_FORMAT(updated_date, '%Y.%m.%d %H:%i:%s') AS updated_date
			FROM
				t_board
			WHERE
				idx = #{idx}
		]]>
	</select>
	
<update id="deleteBoard" parameterType="int">
		<![CDATA[ 
			UPDATE 
				t_board
			SET
				deleted_yn = 'Y'
			WHERE
				idx = #{idx}
		]]>
	</update >
	
	<update id="updateBoard" parameterType="com.bitc.dto.RestBoardDto">
		<![CDATA[ 
			UPDATE
				t_board
			SET
				title = #{title}, contents = #{contents}, update_id = #{creatorId}, updated_date = NOW()
			WHERE
				idx = #{idx}
			AND
				deleted_yn = 'N'
		]]>		
	</update >-->
	
</mapper>
